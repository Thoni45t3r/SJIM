<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="laporan_lhp_pko_line" language="groovy" pageWidth="445" pageHeight="555" orientation="Landscape" columnWidth="445" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="8fadf44c-b530-4668-866a-e82e0cdb97a5">
	<property name="ireport.zoom" value="2.357947691000002"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="mla_id" class="java.lang.Integer"/>
	<queryString language="SQL">
		<![CDATA[SELECT DISTINCT ms.name AS pko_storage,
	mlpl.ffa_mix AS ffa_manual,
	mlpl.iv_mix AS iv_manual,
	sl.name AS pko_location,
	pu.name AS pko_uom,
	mlpl.stock_quantity AS quantity,
	(SELECT sum(product_qty) as qty
            FROM((select product_qty from stock_move
                         where product_id=5521
                                and location_id<>mlpl.location_id
                                and location_dest_id=mlpl.location_id
                                and (date + INTERVAL '7 hours')::TIMESTAMP<(mla.date||' 23:59:59')::TIMESTAMP
                                and state='done')
                  UNION ALL
                  (select  -1*product_qty from stock_move
                          where product_id=5521
                                and location_id=mlpl.location_id
                                and location_dest_id<>mlpl.location_id
                                and (date + INTERVAL '7 hours')::TIMESTAMP<(mla.date||' 23:59:59')::TIMESTAMP
                                and state='done')
                 ) dummy ) AS total_qty
FROM mill_lhp_pko_line mlpl
LEFT JOIN mill_laboratory_analysis mla ON mla.id = mlpl.lab_id
LEFT JOIN mrp_unbuild mu ON mu.id = mla.mill_order_id
LEFT JOIN mill_unbuild_produce_line mupl ON mupl.unbuild_id = mu.id
LEFT JOIN product_uom pu ON pu.id = mlpl.unit_of_measure
LEFT JOIN stock_location sl ON sl.id = mlpl.location_id
LEFT JOIN mill_storage ms ON ms.id = mlpl.storage_id
WHERE mlpl.lab_id=$P{mla_id}
ORDER BY ms.name ASC]]>
	</queryString>
	<field name="pko_location" class="java.lang.String"/>
	<field name="pko_storage" class="java.lang.String"/>
	<field name="pko_uom" class="java.lang.String"/>
	<field name="ffa_manual" class="java.lang.Double"/>
	<field name="iv_manual" class="java.lang.Double"/>
	<field name="quantity" class="java.lang.Double"/>
	<field name="total_qty" class="java.lang.Double"/>
	<group name="lokasi">
		<groupExpression><![CDATA[$F{pko_location}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<detail>
		<band height="15" splitType="Stretch">
			<textField pattern="#,##0;(-#,##0)">
				<reportElement x="0" y="0" width="100" height="15" uuid="0c54fd3b-309a-43c8-b9b6-1ff875950d7f"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="8"/>
					<paragraph leftIndent="1" rightIndent="1"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{pko_location} == null ? " - " : $F{pko_location}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0;(-#,##0)">
				<reportElement x="100" y="0" width="100" height="15" uuid="cebda0e6-e64b-4eb0-9076-188eb4090ad8"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="8"/>
					<paragraph leftIndent="1" rightIndent="1"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{pko_storage} == null ? " - " : $F{pko_storage}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(-#,##0.00)">
				<reportElement x="200" y="0" width="55" height="15" uuid="6d5ed57a-c2f4-47a6-9cbf-b26885f4ee9a"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
					<paragraph leftIndent="1" rightIndent="1"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ffa_manual} == null ? "-": $F{ffa_manual}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(-#,##0.00)">
				<reportElement x="255" y="0" width="57" height="15" uuid="fc5432c7-7fe8-46d2-9edd-c132ef310fe2"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
					<paragraph leftIndent="1" rightIndent="1"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{iv_manual} == null ? "-" : $F{iv_manual}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0;(-#,##0)">
				<reportElement x="312" y="0" width="40" height="15" uuid="616c9253-9f50-4fa3-9e38-c996c9dcbf78"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
					<paragraph leftIndent="1" rightIndent="1"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{pko_uom} == null ? " - " : $F{pko_uom}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0;(-#,##0)">
				<reportElement x="352" y="0" width="75" height="15" uuid="6206c863-7cf9-4f8c-b9ee-d4b0eb72dee2"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
					<paragraph leftIndent="1" rightIndent="1"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{quantity} == null ? 0 : $F{quantity}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="15">
			<staticText>
				<reportElement x="0" y="0" width="352" height="15" uuid="62fa8584-957e-4329-a02c-39c0d0b8e68c"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="9" isBold="true"/>
					<paragraph leftIndent="1"/>
				</textElement>
				<text><![CDATA[Total]]></text>
			</staticText>
			<textField pattern="#,##0;(-#,##0)">
				<reportElement x="352" y="0" width="75" height="15" uuid="15feb6c3-c51c-4883-a9d8-2dbadb739c66"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8"/>
					<paragraph leftIndent="1" rightIndent="1"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{total_qty} == null ? " - " : $F{total_qty}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
